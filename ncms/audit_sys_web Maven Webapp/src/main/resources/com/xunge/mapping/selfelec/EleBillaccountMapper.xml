<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xunge.dao.selfelec.EleBillaccountMapper">
  <resultMap id="BaseResultMap" type="com.xunge.model.selfelec.EleBillaccount">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    <id column="billaccount_id" jdbcType="VARCHAR" property="billaccountId" />
    <result column="preg_id" jdbcType="VARCHAR" property="pregId" />
    <result column="preg_name" jdbcType="VARCHAR" property="pregName" />
    <result column="reg_id" jdbcType="VARCHAR" property="regId" />
    <result column="reg_name" jdbcType="VARCHAR" property="regName" />
    <result column="billaccount_code" jdbcType="VARCHAR" property="billaccountCode" />
    <result column="billaccount_name" jdbcType="VARCHAR" property="billaccountName" />
    <result column="billaccount_state" jdbcType="INTEGER" property="billaccountState" />
    <result column="billaccount_type" jdbcType="INTEGER" property="billaccountType" />
    <result column="plan_date" jdbcType="TIMESTAMP" property="planDate" />
    <result column="calc_multi" jdbcType="DECIMAL" property="calcMulti" />
    <result column="auditing_state" jdbcType="INTEGER" property="auditingState" />
    <result column="auditing_user_id" jdbcType="VARCHAR" property="auditingUserId" />
    <result column="auditing_date" jdbcType="TIMESTAMP" property="auditingDate" />
    <result column="billaccount_note" jdbcType="VARCHAR" property="billaccountNote" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    billaccount_id, preg_id, preg_name, reg_id, reg_name, billaccount_code, billaccount_name, 
    billaccount_state, billaccount_type, plan_date, calc_multi, auditing_state, auditing_user_id, 
    auditing_date, billaccount_note
  </sql>
  <select id="selectByExample" parameterType="com.xunge.model.selfelec.EleBillaccountExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from ele_billaccount
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from ele_billaccount
    where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </select>
  <!-- 删除报账点  -->
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    delete from ele_billaccount
    where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </delete>
    <!-- 删除报账点  -->
  <update id="updateStateByPrimaryKey" parameterType="java.lang.String">
    update ele_billaccount
    set billaccount_state = -1 where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </update>
  <!-- 删除报账点与合同关联关系 -->
  <update id="deleteBillaccountContract" parameterType="Map">
    update ele_contractbillaccount
    set relation_state = 9,
    relation_enddate=#{relationEnddate,jdbcType=DATE}
    where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </update>
  <!-- 删除报账点与资源关联关系 -->
  <update id="deleteBillaccountResource" parameterType="Map">
    update ele_billaccountbaseresource
    set relation_state = 9,
    relation_enddate=#{relationEnddate,jdbcType=DATE}
    where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </update>
  <delete id="deleteByExample" parameterType="com.xunge.model.selfelec.EleBillaccountExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    delete from ele_billaccount
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.xunge.model.selfelec.EleBillaccount">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    insert into ele_billaccount (billaccount_id, preg_id, preg_name, 
      reg_id, reg_name, billaccount_code, 
      billaccount_name, billaccount_state, billaccount_type, 
      plan_date, calc_multi, auditing_state, 
      auditing_user_id, auditing_date, billaccount_note
      )
    values (#{billaccountId,jdbcType=VARCHAR}, #{pregId,jdbcType=VARCHAR}, #{pregName,jdbcType=VARCHAR}, 
      #{regId,jdbcType=VARCHAR}, #{regName,jdbcType=VARCHAR}, #{billaccountCode,jdbcType=VARCHAR}, 
      #{billaccountName,jdbcType=VARCHAR}, #{billaccountState,jdbcType=INTEGER}, #{billaccountType,jdbcType=INTEGER}, 
      #{planDate,jdbcType=TIMESTAMP}, #{calcMulti,jdbcType=DECIMAL}, #{auditingState,jdbcType=INTEGER}, 
      #{auditingUserId,jdbcType=VARCHAR}, #{auditingDate,jdbcType=TIMESTAMP}, #{billaccountNote,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" useGeneratedKeys="true" keyProperty="billaccountId"  parameterType="com.xunge.model.selfelec.EleBillaccount">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    insert into ele_billaccount
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="billaccountId != null">
        billaccount_id,
      </if>
      <if test="pregId != null">
        preg_id,
      </if>
      <if test="pregName != null">
        preg_name,
      </if>
      <if test="regId != null">
        reg_id,
      </if>
      <if test="regName != null">
        reg_name,
      </if>
      <if test="billaccountCode != null">
        billaccount_code,
      </if>
      <if test="billaccountName != null">
        billaccount_name,
      </if>
      <if test="billaccountState != null">
        billaccount_state,
      </if>
      <if test="billaccountType != null">
        billaccount_type,
      </if>
      <if test="planDate != null">
        plan_date,
      </if>
      <if test="calcMulti != null">
        calc_multi,
      </if>
      <if test="auditingState != null">
        auditing_state,
      </if>
      <if test="auditingUserId != null">
        auditing_user_id,
      </if>
      <if test="auditingDate != null">
        auditing_date,
      </if>
      <if test="billaccountNote != null">
        billaccount_note,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="billaccountId != null">
        #{billaccountId,jdbcType=VARCHAR},
      </if>
      <if test="pregId != null">
        #{pregId,jdbcType=VARCHAR},
      </if>
      <if test="pregName != null">
        #{pregName,jdbcType=VARCHAR},
      </if>
      <if test="regId != null">
        #{regId,jdbcType=VARCHAR},
      </if>
      <if test="regName != null">
        #{regName,jdbcType=VARCHAR},
      </if>
      <if test="billaccountCode != null">
        #{billaccountCode,jdbcType=VARCHAR},
      </if>
      <if test="billaccountName != null">
        #{billaccountName,jdbcType=VARCHAR},
      </if>
      <if test="billaccountState != null">
        #{billaccountState,jdbcType=INTEGER},
      </if>
      <if test="billaccountType != null">
        #{billaccountType,jdbcType=INTEGER},
      </if>
      <if test="planDate != null">
        #{planDate,jdbcType=TIMESTAMP},
      </if>
      <if test="calcMulti != null">
        #{calcMulti,jdbcType=DECIMAL},
      </if>
      <if test="auditingState != null">
        #{auditingState,jdbcType=INTEGER},
      </if>
      <if test="auditingUserId != null">
        #{auditingUserId,jdbcType=VARCHAR},
      </if>
      <if test="auditingDate != null">
        #{auditingDate,jdbcType=TIMESTAMP},
      </if>
      <if test="billaccountNote != null">
        #{billaccountNote,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.xunge.model.selfelec.EleBillaccountExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    select count(*) from ele_billaccount
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    update ele_billaccount
    <set>
      <if test="record.billaccountId != null">
        billaccount_id = #{record.billaccountId,jdbcType=VARCHAR},
      </if>
      <if test="record.pregId != null">
        preg_id = #{record.pregId,jdbcType=VARCHAR},
      </if>
      <if test="record.pregName != null">
        preg_name = #{record.pregName,jdbcType=VARCHAR},
      </if>
      <if test="record.regId != null">
        reg_id = #{record.regId,jdbcType=VARCHAR},
      </if>
      <if test="record.regName != null">
        reg_name = #{record.regName,jdbcType=VARCHAR},
      </if>
      <if test="record.billaccountCode != null">
        billaccount_code = #{record.billaccountCode,jdbcType=VARCHAR},
      </if>
      <if test="record.billaccountName != null">
        billaccount_name = #{record.billaccountName,jdbcType=VARCHAR},
      </if>
      <if test="record.billaccountState != null">
        billaccount_state = #{record.billaccountState,jdbcType=INTEGER},
      </if>
      <if test="record.billaccountType != null">
        billaccount_type = #{record.billaccountType,jdbcType=INTEGER},
      </if>
      <if test="record.planDate != null">
        plan_date = #{record.planDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.calcMulti != null">
        calc_multi = #{record.calcMulti,jdbcType=DECIMAL},
      </if>
      <if test="record.auditingState != null">
        auditing_state = #{record.auditingState,jdbcType=INTEGER},
      </if>
      <if test="record.auditingUserId != null">
        auditing_user_id = #{record.auditingUserId,jdbcType=VARCHAR},
      </if>
      <if test="record.auditingDate != null">
        auditing_date = #{record.auditingDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.billaccountNote != null">
        billaccount_note = #{record.billaccountNote,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    update ele_billaccount
    set billaccount_id = #{record.billaccountId,jdbcType=VARCHAR},
      preg_id = #{record.pregId,jdbcType=VARCHAR},
      preg_name = #{record.pregName,jdbcType=VARCHAR},
      reg_id = #{record.regId,jdbcType=VARCHAR},
      reg_name = #{record.regName,jdbcType=VARCHAR},
      billaccount_code = #{record.billaccountCode,jdbcType=VARCHAR},
      billaccount_name = #{record.billaccountName,jdbcType=VARCHAR},
      billaccount_state = #{record.billaccountState,jdbcType=INTEGER},
      billaccount_type = #{record.billaccountType,jdbcType=INTEGER},
      plan_date = #{record.planDate,jdbcType=TIMESTAMP},
      calc_multi = #{record.calcMulti,jdbcType=DECIMAL},
      auditing_state = #{record.auditingState,jdbcType=INTEGER},
      auditing_user_id = #{record.auditingUserId,jdbcType=VARCHAR},
      auditing_date = #{record.auditingDate,jdbcType=TIMESTAMP},
      billaccount_note = #{record.billaccountNote,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  
  <!-- 修改流程方法 -->
  <update id="updateActivityCommit" parameterType="Map" >
  	
  	update ele_billaccount set auditing_state=#{state} where billaccount_id=#{billaccountId}
  
  </update>
  
  <update id="updateByPrimaryKeySelective" parameterType="com.xunge.model.selfelec.EleBillaccount">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    update ele_billaccount
    <set>
      <if test="pregId != null">
        preg_id = #{pregId,jdbcType=VARCHAR},
      </if>
      <if test="pregName != null">
        preg_name = #{pregName,jdbcType=VARCHAR},
      </if>
      <if test="regId != null">
        reg_id = #{regId,jdbcType=VARCHAR},
      </if>
      <if test="regName != null">
        reg_name = #{regName,jdbcType=VARCHAR},
      </if>
      <if test="billaccountCode != null">
        billaccount_code = #{billaccountCode,jdbcType=VARCHAR},
      </if>
      <if test="billaccountName != null">
        billaccount_name = #{billaccountName,jdbcType=VARCHAR},
      </if>
      <if test="billaccountState != null">
        billaccount_state = #{billaccountState,jdbcType=INTEGER},
      </if>
      <if test="billaccountType != null">
        billaccount_type = #{billaccountType,jdbcType=INTEGER},
      </if>
      <if test="planDate != null">
        plan_date = #{planDate,jdbcType=TIMESTAMP},
      </if>
      <if test="calcMulti != null">
        calc_multi = #{calcMulti,jdbcType=DECIMAL},
      </if>
      <if test="auditingState != null">
        auditing_state = #{auditingState,jdbcType=INTEGER},
      </if>
      <if test="auditingUserId != null">
        auditing_user_id = #{auditingUserId,jdbcType=VARCHAR},
      </if>
      <if test="auditingDate != null">
        auditing_date = #{auditingDate,jdbcType=TIMESTAMP},
      </if>
      <if test="billaccountNote != null">
        billaccount_note = #{billaccountNote,jdbcType=VARCHAR},
      </if>
    </set>
    where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.xunge.model.selfelec.EleBillaccount">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jul 02 03:52:13 CST 2017.
    -->
    update ele_billaccount
    set preg_id = #{pregId,jdbcType=VARCHAR},
      preg_name = #{pregName,jdbcType=VARCHAR},
      reg_id = #{regId,jdbcType=VARCHAR},
      reg_name = #{regName,jdbcType=VARCHAR},
      billaccount_code = #{billaccountCode,jdbcType=VARCHAR},
      billaccount_name = #{billaccountName,jdbcType=VARCHAR},
      billaccount_state = #{billaccountState,jdbcType=INTEGER},
      billaccount_type = #{billaccountType,jdbcType=INTEGER},
      plan_date = #{planDate,jdbcType=TIMESTAMP},
      calc_multi = #{calcMulti,jdbcType=DECIMAL},
      auditing_state = #{auditingState,jdbcType=INTEGER},
      auditing_user_id = #{auditingUserId,jdbcType=VARCHAR},
      auditing_date = #{auditingDate,jdbcType=TIMESTAMP},
      billaccount_note = #{billaccountNote,jdbcType=VARCHAR}
    where billaccount_id = #{billaccountId,jdbcType=VARCHAR}
  </update>
  
  <!-- 审核主页面查询 -->
  <select id="queryEleBillaccount" parameterType="Map" resultMap="BaseResultMap">
	SELECT
	<include refid="Base_Column_List" />
    from ele_billaccount
  	<where>
  			<if test="billaccountName != '' and billaccountName != null">
				and billaccount_name like CONCAT('%',#{billaccountName,jdbcType=VARCHAR},'%')
			</if>
			<if test="billaccountCode != '' and billaccountCode != null">
				and billaccount_code like CONCAT('%',#{billaccountCode,jdbcType=VARCHAR},'%')
			</if>
			<if test="regId != '' and regId != null">
				and reg_id = #{regId,jdbcType=VARCHAR}
			</if>
			<if test="pregId != '' and pregId != null">
				and preg_id = #{pregId,jdbcType=VARCHAR}
			</if>
			<if test="billaccountState != '' and billaccountState != null">
				and billaccount_state = #{billaccountState,jdbcType=VARCHAR}
			</if>
			<!-- 审核状态 -->
			<if test="auditingState != '' and auditingState != null">
				and auditing_State = #{auditingState,jdbcType=VARCHAR}
			</if>
			<if test="auditingUserId != '' and auditingUserId != null">
				and auditing_User_Id = #{auditingUserId,jdbcType=VARCHAR}
			</if>
			 <!-- 根据权限过滤 -->
   			<!-- 	<include refid="com.xunge.dao.system.SysRegionVOMapper.queryRegionByUserIds"></include> -->
			<!-- 流程实例id集合 -->
			  <if test="idsList != null and idsList.size()>0">  
	        	and billaccount_id in  
		        <foreach collection="idsList" item="item" index="index" open="(" separator="," close=")">  
	                #{item.businessId}
	            </foreach>  
    		</if>
    		<if test="regIds !=null and regIds.size()>0">
				and reg_id in
				<foreach collection="regIds" item="item" index="index" open="("
					separator="," close=")">
					#{item}
				</foreach>
			</if> 
    		 
		</where>
  </select>
  
 <select id="queryBillaccountById" parameterType="Map" resultMap="BaseResultMap">
	SELECT
	<include refid="Base_Column_List" />
    from ele_billaccount
  	<where>
			<if test="regId != '' and regId != null">
				and reg_id = #{regId,jdbcType=VARCHAR}
			</if>
			<if test="pregId != '' and pregId != null">
				and preg_id = #{pregId,jdbcType=VARCHAR}
			</if>
			 <if test="billaccountId != '' and billaccountId != null">
				and billaccount_id = #{billaccountId,jdbcType=VARCHAR}
			</if> 
		</where>
  </select>
  
  <!-- 报账标杆查询 -->
  <resultMap id="BillResultMap" type="com.xunge.model.selfelec.EleBenchmarkBillaccountBean">
    <id column="billaccount_id" jdbcType="VARCHAR" property="billaccountId" />
    <result column="billaccount_code" jdbcType="VARCHAR" property="billaccountCode" />
    <result column="billaccount_name" jdbcType="VARCHAR" property="billaccountName" />
    <result column="billaccount_state" jdbcType="VARCHAR" property="billaccountState" />
    <result column="preg_name" jdbcType="VARCHAR" property="pregName" />
    <result column="reg_name" jdbcType="VARCHAR" property="regName" />
    <result column="col_date" jdbcType="TIMESTAMP" property="colDate" />
    <result column="electricmeter_degree" jdbcType="DECIMAL" property="electricmeterDegree" />
    <result column="powerload_degree" jdbcType="DECIMAL" property="powerloadDegree" />
    <result column="powerrating_degree" jdbcType="DECIMAL" property="powerratingDegree" />
  </resultMap>
  
  <select id="queryPageEleBillBenchmark" parameterType="java.util.Map" resultMap="BillResultMap">
	SELECT eb.prv_id,eb.prv_sname,eb.preg_id,eb.preg_name,eb.reg_id,eb.reg_name,
	eb.billaccount_code,eb.billaccount_name,
	eb.billaccount_state,
	ebb.*
	FROM ele_billaccount AS eb,ele_benchmark_billaccount AS ebb
	WHERE eb.billaccount_id = ebb.billaccount_id
	<if test=" prvId != null and prvId != ''">
		AND eb.prv_id = #{prvId}
	</if>
	<if test=" pregId != null and pregId != ''">
		AND eb.preg_id= #{pregId}
	</if>
	<if test=" regId != null and regId != ''">
		AND eb.reg_id = #{regId}
	</if> 
	<if test="billaccountState != null and billaccountState != ''">
		AND eb.billaccount_state = #{billaccountState}
	</if>	
	<if test="billaccountCode != null and billaccountCode != ''">
		AND (
		INSTR(eb.billaccount_code,#{billaccountCode}) OR INSTR(eb.billaccount_name,#{billaccountCode})
		)
	</if>
	<if test=" year != null and year != '' and month != null and month!= ''">
		AND col_date  &gt;= #{monthstartday} AND col_date &lt;= #{monthendday}
	</if>
	<if test=" pregIds != null and pregIds != ''">
		AND eb.preg_id IN
		<foreach collection="pregIds" index="index" item="item" open="(" separator="," close=")">    
            #{item}    
        </foreach>  
	</if>
	<if test=" regIds != null and regIds != ''">
		AND eb.reg_id IN
		<foreach collection="regIds" index="index" item="item" open="(" separator="," close=")">    
            #{item}    
        </foreach>  
	</if>
	GROUP BY ebb.billaccount_id
  </select>
  
  <select id="queryEleBillBenchmark" parameterType="java.util.Map" resultMap="BillResultMap">
	SELECT eb.prv_id,eb.prv_sname,eb.preg_id,eb.preg_name,eb.reg_id,eb.reg_name,
	eb.billaccount_code,eb.billaccount_name,
	eb.billaccount_state,
	ebb.*
	FROM ele_billaccount AS eb,ele_benchmark_billaccount AS ebb
	WHERE eb.billaccount_id = ebb.billaccount_id
	<if test=" prvId != null and prvId != ''">
		AND eb.prv_id = #{prvId}
	</if>
	<if test=" pregId != null and pregId != ''">
		AND eb.preg_id= #{pregId}
	</if>
	<if test=" regId != null and regId != ''">
		AND eb.reg_id = #{regId}
	</if> 
	<if test="billaccountState != null and billaccountState != ''">
		AND eb.billaccount_state = #{billaccountState}
	</if>	
	<if test="billaccountCode != null and billaccountCode != ''">
		AND (
		INSTR(eb.billaccount_code,#{billaccountCode}) OR INSTR(eb.billaccount_name,#{billaccountCode})
		)
	</if>
	<if test=" year != null and year != '' and month != null and month!= ''">
		AND col_date  &gt;= #{monthstartday} AND col_date &lt;= #{monthendday}
	</if>
	<if test=" pregIds != null and pregIds != ''">
		AND eb.preg_id IN
		<foreach collection="pregIds" index="index" item="item" open="(" separator="," close=")">    
            #{item}    
        </foreach>  
	</if>
	<if test=" regIds != null and regIds != ''">
		AND eb.reg_id IN
		<foreach collection="regIds" index="index" item="item" open="(" separator="," close=")">    
            #{item}    
        </foreach>  
	</if>
  </select>
  
  <select id="queryEleBillaccountById" parameterType="Map" resultMap="BaseResultMap">
	SELECT 
 	<include refid="Base_Column_List" />
	FROM ele_billaccount 
	WHERE billaccount_id =#{billaccountId,jdbcType=VARCHAR}
  </select>
  
   <!-- 修改计划缴费日期 -->
  <update id="updatePlanDateById" parameterType="Map" >
  	
  	update ele_billaccount set plan_date=#{planDate} where billaccount_id=#{billaccountId}
  
  </update>
</mapper>